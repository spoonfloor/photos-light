<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Date Edit Error - Mockup</title>
  
  <!-- Material Symbols -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,200,0,0" />
  
  <style>
    :root {
      --app-bar-bg: #1f1f1f;
      --body-bg: #121212;
      --text-primary: #e8e8e8;
      --text-secondary: #b3b3b3;
      --placeholder-bg: #2a2a2a;
      --placeholder-hover: #333333;
      --accent-color: #6d49ff;
      --accent-hover: #5a3ad6;
      --hover-bg: rgba(255, 255, 255, 0.05);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 15.5px;
      line-height: 1.6;
      color: var(--text-primary);
      background: var(--body-bg);
      padding: 40px;
    }

    /* Demo Controls */
    .demo-controls {
      max-width: 600px;
      margin: 0 auto 40px;
      padding: 20px;
      background: #2a2a2a;
      border: 1px solid #444;
      border-radius: 8px;
    }

    .demo-controls h3 {
      margin: 0 0 12px 0;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .demo-controls button {
      margin-right: 8px;
      margin-bottom: 8px;
      padding: 8px 16px;
      border-radius: 6px;
      border: 1px solid #444;
      background: var(--placeholder-bg);
      color: var(--text-primary);
      cursor: pointer;
      font-size: 13px;
    }

    .demo-controls button:hover {
      background: var(--placeholder-hover);
    }

    /* Dialog Overlay */
    .dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20000;
    }

    .dialog-overlay.hidden {
      display: none;
    }

    /* Import Card Style (matching existing patterns) */
    .import-card {
      background: #1f1f1f;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      width: 500px;
      max-width: calc(100vw - 40px);
      max-height: calc(100vh - 40px);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* Header */
    .import-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px 16px 24px;
    }

    .import-title {
      font-size: 18px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .import-close-btn {
      background: none;
      border: none;
      padding: 4px;
      cursor: pointer;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }

    .import-close-btn:hover {
      background: var(--hover-bg);
    }

    /* Message Section */
    .dialog-message {
      padding: 20px 24px;
      font-size: 15px;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    /* Stats Section */
    .error-stats {
      padding: 16px 24px;
      background: rgba(244, 67, 54, 0.1);
    }

    .error-stat {
      display: flex;
      align-items: center;
      gap: 12px;
      color: #f44336;
      font-size: 14px;
      font-weight: 500;
    }

    .error-stat .material-symbols-outlined {
      font-size: 20px;
    }

    /* Details Section */
    .import-details-section {
    }

    .import-details-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      background: none;
      border: none;
      padding: 16px 24px;
      cursor: pointer;
      color: var(--text-secondary);
      font-size: 14px;
      width: 100%;
      transition: color 0.2s;
    }

    .import-details-toggle:hover {
      color: var(--text-primary);
      background: var(--hover-bg);
    }

    .import-details-toggle .material-symbols-outlined {
      font-size: 20px;
      transition: transform 0.2s;
    }

    .import-details-toggle.expanded .material-symbols-outlined {
      transform: rotate(180deg);
    }

    .import-details-list {
      max-height: 300px;
      overflow-y: auto;
      padding: 0 24px 16px 24px;
    }

    .import-details-list.hidden {
      display: none;
    }

    /* Detail Items */
    .import-detail-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px 0;
      font-size: 13px;
    }

    .import-detail-item:last-child {
      border-bottom: none;
    }

    .import-detail-icon {
      font-size: 18px;
      margin-top: 1px;
      flex-shrink: 0;
    }

    .import-detail-icon.error {
      color: #f44336;
    }

    .import-detail-text {
      flex: 1;
      color: var(--text-primary);
      line-height: 1.4;
      word-break: break-word;
    }

    .import-detail-message {
      color: var(--text-secondary);
      font-size: 12px;
      margin-top: 4px;
    }

    .import-detail-item em {
      color: var(--text-secondary);
      font-style: italic;
    }

    /* Actions */
    .import-actions {
      display: flex;
      gap: 12px;
      padding: 20px 24px;
      justify-content: flex-end;
    }

    .import-btn {
      padding: 10px 24px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: all 0.2s;
    }

    .import-btn-primary {
      background: var(--accent-color);
      color: white;
    }

    .import-btn-primary:hover {
      background: var(--accent-hover);
    }

    /* Scrollbar */
    .import-details-list::-webkit-scrollbar {
      width: 8px;
    }

    .import-details-list::-webkit-scrollbar-track {
      background: transparent;
    }

    .import-details-list::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 4px;
    }

    .import-details-list::-webkit-scrollbar-thumb:hover {
      background: #444;
    }
  </style>
</head>
<body>

  <div class="demo-controls">
    <h3>ðŸŽ¬ Demo Controls - Click to simulate states:</h3>
    <button onclick="showSmallError()">Small Error (3 files)</button>
    <button onclick="showMediumError()">Medium Error (15 files)</button>
    <button onclick="showLargeError()">Large Error (2,325 files)</button>
    <button onclick="toggleDetails()">Toggle Details</button>
    <button onclick="hideDialog()">Close Dialog</button>
  </div>

  <!-- Dialog -->
  <div class="dialog-overlay" id="dialogOverlay">
    <div class="import-card">
      <!-- Header -->
      <div class="import-header">
        <span class="import-title">Date update failed</span>
        <button class="import-close-btn" onclick="hideDialog()">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>

      <!-- Message -->
      <div class="dialog-message" id="dialogMessage">
        Failed to update 3 of 3 files. All changes have been rolled back.
      </div>

      <!-- Error Stats -->
      <div class="error-stats">
        <div class="error-stat">
          <span class="material-symbols-outlined">error</span>
          <span id="errorCount">3 files couldn't be updated</span>
        </div>
      </div>

      <!-- Details Section -->
      <div class="import-details-section">
        <button class="import-details-toggle" id="detailsToggle" onclick="toggleDetails()">
          <span class="material-symbols-outlined">expand_more</span>
          <span>Show error details</span>
        </button>
        
        <div class="import-details-list hidden" id="detailsList">
          <!-- Populated dynamically -->
        </div>
      </div>

      <!-- Actions -->
      <div class="import-actions">
        <button class="import-btn import-btn-primary" onclick="hideDialog()">
          OK
        </button>
      </div>
    </div>
  </div>

  <script>
    const dialogOverlay = document.getElementById('dialogOverlay');
    const dialogMessage = document.getElementById('dialogMessage');
    const errorCount = document.getElementById('errorCount');
    const detailsList = document.getElementById('detailsList');
    const detailsToggle = document.getElementById('detailsToggle');

    // Sample error data
    const errors = {
      small: [
        { file: 'img_20240315_a1b2c3d.jpg', error: 'Permission denied: read-only filesystem' },
        { file: 'img_20240316_e4f5g6h.jpg', error: 'exiftool timeout after 30s' },
        { file: 'video_20240317_i7j8k9l.mov', error: 'ffmpeg failed: unsupported codec' }
      ],
      medium: [
        { file: 'img_20240315_a1b2c3d.jpg', error: 'Permission denied: read-only filesystem' },
        { file: 'img_20240316_e4f5g6h.jpg', error: 'exiftool timeout after 30s' },
        { file: 'img_20240317_i7j8k9l.jpg', error: 'File not found' },
        { file: 'img_20240318_m1n2o3p.jpg', error: 'Disk full: no space left on device' },
        { file: 'img_20240319_q4r5s6t.jpg', error: 'Permission denied: read-only filesystem' },
        { file: 'img_20240320_u7v8w9x.jpg', error: 'EXIF write failed: corrupted file header' },
        { file: 'video_20240321_y1z2a3b.mov', error: 'ffmpeg failed: invalid stream' },
        { file: 'img_20240322_c4d5e6f.jpg', error: 'Path too long (Windows 260-char limit)' },
        { file: 'img_20240323_g7h8i9j.jpg', error: 'exiftool timeout after 30s' },
        { file: 'img_20240324_k1l2m3n.jpg', error: 'Permission denied: file locked by another process' },
        { file: 'img_20240325_o4p5q6r.heic', error: 'HEIC write failed: unsupported format variant' },
        { file: 'img_20240326_s7t8u9v.jpg', error: 'Network mount timeout' },
        { file: 'img_20240327_w1x2y3z.jpg', error: 'File not found' },
        { file: 'img_20240328_a4b5c6d.jpg', error: 'Permission denied: read-only filesystem' },
        { file: 'img_20240329_e7f8g9h.jpg', error: 'exiftool crashed: segmentation fault' }
      ],
      large: []
    };

    // Generate large error list (2,325 files)
    for (let i = 0; i < 2325; i++) {
      const errorTypes = [
        'Permission denied: read-only filesystem',
        'exiftool timeout after 30s',
        'File not found',
        'Disk full: no space left on device',
        'EXIF write failed: corrupted file',
        'ffmpeg failed: unsupported codec',
        'Network mount timeout'
      ];
      const hash = Math.random().toString(36).substring(7);
      errors.large.push({
        file: `img_20240${String(i % 12 + 1).padStart(2, '0')}${String(i % 28 + 1).padStart(2, '0')}_${hash}.jpg`,
        error: errorTypes[i % errorTypes.length]
      });
    }

    function showSmallError() {
      dialogMessage.textContent = 'Failed to update 3 of 3 files. All changes have been rolled back.';
      errorCount.textContent = '3 files couldn\'t be updated';
      populateErrorList(errors.small);
      dialogOverlay.classList.remove('hidden');
    }

    function showMediumError() {
      dialogMessage.textContent = 'Failed to update 15 of 127 files. All changes have been rolled back.';
      errorCount.textContent = '15 files couldn\'t be updated';
      populateErrorList(errors.medium);
      dialogOverlay.classList.remove('hidden');
    }

    function showLargeError() {
      dialogMessage.textContent = 'Failed to update 2,325 of 2,325 files. All changes have been rolled back.';
      errorCount.textContent = '2,325 files couldn\'t be updated';
      populateErrorList(errors.large);
      dialogOverlay.classList.remove('hidden');
    }

    function populateErrorList(errorData) {
      const MAX_DISPLAY = 20;
      let html = '';

      // Show first 20
      errorData.slice(0, MAX_DISPLAY).forEach(item => {
        html += `
          <div class="import-detail-item">
            <span class="material-symbols-outlined import-detail-icon error">error</span>
            <div class="import-detail-text">
              <div>${item.file}</div>
              <div class="import-detail-message">${item.error}</div>
            </div>
          </div>
        `;
      });

      // Show "and N more" if capped
      if (errorData.length > MAX_DISPLAY) {
        html += `
          <div class="import-detail-item">
            <div class="import-detail-text">
              <em>... and ${(errorData.length - MAX_DISPLAY).toLocaleString()} more</em>
            </div>
          </div>
        `;
      }

      detailsList.innerHTML = html;
      
      // Reset to collapsed state
      detailsList.classList.add('hidden');
      detailsToggle.classList.remove('expanded');
      detailsToggle.querySelector('span:last-child').textContent = 'Show error details';
    }

    function toggleDetails() {
      const isExpanded = detailsToggle.classList.toggle('expanded');
      detailsList.classList.toggle('hidden');
      detailsToggle.querySelector('span:last-child').textContent = 
        isExpanded ? 'Hide error details' : 'Show error details';
    }

    function hideDialog() {
      dialogOverlay.classList.add('hidden');
    }

    // Show small error on load
    setTimeout(() => {
      showSmallError();
    }, 500);
  </script>

</body>
</html>
